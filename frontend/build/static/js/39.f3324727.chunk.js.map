{"version":3,"sources":["views/web/videoChat/Participant.js","views/web/videoChat/Room.js","views/web/videoChat/VideoChat.js","components/common/Loading.js"],"names":["Participant","_ref","participant","_ref$isAudio","isAudio","_ref$isVideo","isVideo","localUser","isVoiceCall","_useState","useState","_useState2","_slicedToArray","videoTracks","setVideoTracks","_useState3","_useState4","audioTracks","setAudioTracks","_useState5","_useState6","videoDisable","setVideoDisable","videoRef","useRef","audioRef","trackpubsToTracks","trackMap","Array","from","values","map","publication","track","filter","trackSubscribed","kind","concat","_toConsumableArray","trackUnsubscribed","v","a","useEffect","on","removeAllListeners","videoTrack","attach","current","isEnabled","enable","error","console","log","disable","detach","audioTrack","_jsx","_Fragment","children","_jsxs","ref","autoPlay","className","muted","Room","_bookingData$doctorDa","_bookingData$doctorDa2","_bookingData$doctorDa3","_bookingData$doctorDa4","_bookingData$doctorDa6","_bookingData$patientD2","_bookingData$bookingD","roomName","room","handleLogout","userId","role","participants","setParticipants","setIsVideo","setIsAudio","_useQuery","useQuery","headers","API","get","data","staleTime","isLoading","bookingData","profileImage","doctorData","image","url","profileImageURL","participantConnected","prevParticipants","participantDisconnected","p","forEach","off","remoteParticipants","length","sid","onClick","src","alt","prev","localParticipant","_bookingData$doctorDa5","_bookingData$patientD","_id","patientData","Swal","fire","history","push","getRedirection","docProfile","name","formatDate","parseISO","bookingDate","start","title","text","icon","showCancelButton","cancelButtonText","confirmButtonText","confirmButtonColor","then","result","isConfirmed","VideoChat","user","useSelector","state","auth","queryUrl","URLSearchParams","useLocation","search","roomId","userName","setRoom","setConnecting","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","wrap","_context","next","post","bookingId","sent","Video","connect","token","t0","stop","apply","arguments","connectVideo","useCallback","prevRoom","tracks","trackPub","disconnect","tidyUp","event","persisted","window","addEventListener","removeEventListener","Loading","_ref$height","height","style","width","LoadingComponent"],"mappings":"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","file":"static/js/39.f3324727.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\n\nconst Participant = ({\n  participant,\n  isAudio = true,\n  isVideo = true,\n  localUser,\n  isVoiceCall,\n}) => {\n  const [videoTracks, setVideoTracks] = useState([]);\n  const [audioTracks, setAudioTracks] = useState([]);\n  const [videoDisable, setVideoDisable] = useState(false);\n\n  const videoRef = useRef();\n  const audioRef = useRef();\n\n  const trackpubsToTracks = (trackMap) =>\n    Array.from(trackMap.values())\n      .map((publication) => publication.track)\n      .filter((track) => track !== null);\n\n  const trackSubscribed = (track) => {\n    if (track.kind === \"video\") {\n      setVideoTracks((videoTracks) => [...videoTracks, track]);\n    } else if (track.kind === \"audio\") {\n      setAudioTracks((audioTracks) => [...audioTracks, track]);\n    }\n  };\n\n  const trackUnsubscribed = (track) => {\n    if (track.kind === \"video\") {\n      setVideoTracks((videoTracks) => videoTracks.filter((v) => v !== track));\n    } else if (track.kind === \"audio\") {\n      setAudioTracks((audioTracks) => audioTracks.filter((a) => a !== track));\n    }\n  };\n  useEffect(() => {\n    setVideoTracks(trackpubsToTracks(participant.videoTracks));\n    setAudioTracks(trackpubsToTracks(participant.audioTracks));\n\n    participant.on(\"trackSubscribed\", trackSubscribed);\n    participant.on(\"trackUnsubscribed\", trackUnsubscribed);\n\n    return () => {\n      setVideoTracks([]);\n      setAudioTracks([]);\n      participant.removeAllListeners();\n    };\n  }, [participant]);\n\n  useEffect(() => {\n    const videoTrack = videoTracks[0];\n    if (videoTrack) {\n      videoTrack.on(\"disabled\", () => {\n        setVideoDisable(true);\n      });\n      videoTrack.on(\"enabled\", () => {\n        setVideoDisable(false);\n        videoTrack.attach(videoRef.current);\n      });\n      const isEnabled = videoTrack.isEnabled;\n      if (isVideo) {\n        if (!isEnabled) {\n          try {\n            videoTrack.enable();\n          } catch (error) {\n            console.log(error);\n          }\n        }\n        videoTrack.attach(videoRef.current);\n      } else {\n        videoTrack.disable();\n      }\n      return () => {\n        videoTrack.detach();\n      };\n    }\n  }, [videoTracks, isVideo]);\n\n  useEffect(() => {\n    const audioTrack = audioTracks[0];\n    if (audioTrack) {\n      audioTrack.on(\"disabled\", () => {\n        audioTrack.detach();\n      });\n      audioTrack.on(\"enabled\", () => {\n        audioTrack.attach(audioRef.current);\n      });\n      if (isAudio) {\n        !audioTrack.isEnabled && audioTrack.enable();\n        audioTrack.attach(audioRef.current);\n      } else audioTrack.disable();\n      return () => {\n        audioTrack.detach();\n      };\n    }\n  }, [audioTracks, isAudio]);\n\n  // only for audio call page\n  useEffect(() => {\n    const videoTrack = videoTracks[0];\n    if (isVoiceCall && videoTrack) {\n      try {\n        videoTrack.disable();\n        videoTrack.detach();\n      } catch (error) {\n        console.log(error);\n      }\n    }\n    return () => {};\n  }, []);\n\n  // main return\n  return (\n    <>\n      {localUser ? (\n        <>\n          {isVideo ? (\n            <video ref={videoRef} autoPlay={true} />\n          ) : (\n            <div className=\"camOff centerFlex\"> Cam off </div>\n          )}\n          <audio ref={audioRef} autoPlay={true} muted={!isAudio} />\n        </>\n      ) : (\n        <>\n          {videoDisable ? (\n            <div className=\"title\">Participant have turned off thier Cam</div>\n          ) : (\n            <>\n              <video ref={videoRef} autoPlay={true} />\n            </>\n          )}\n          <audio ref={audioRef} autoPlay={true} muted={false} />\n        </>\n      )}\n    </>\n  );\n};\n\nexport default Participant;\n","import React, { useEffect, useState } from \"react\";\nimport { format as formatDate, parseISO } from \"date-fns\";\nimport { useQuery } from \"react-query\";\nimport Swal from \"sweetalert2\";\nimport { docProfile } from \"../../../assets\";\nimport API from \"../../../config/AxiosBase\";\nimport { headers } from \"../../../helpers/helpers\";\nimport { profileImageURL } from \"../../../helpers/helpers\";\nimport history from \"../../../helpers/history\";\nimport Participant from \"./Participant\";\n\nconst Room = ({ roomName, room, handleLogout, userId, role }) => {\n  const [participants, setParticipants] = useState([]);\n  const [isVideo, setIsVideo] = useState(true);\n  const [isAudio, setIsAudio] = useState(true);\n\n  const getBookingDetails = () => {\n    headers();\n    return API.get(`/booking/${roomName}`, data);\n  };\n  const { isLoading, data } = useQuery(\"bookingDetails\", getBookingDetails, {\n    staleTime: 100 * 60,\n  });\n  const bookingData = data?.data;\n  const profileImage =\n    bookingData?.doctorData?.image?.url !== \"None\" &&\n    profileImageURL + bookingData?.doctorData?.image?.url;\n  useEffect(() => {\n    const participantConnected = (participant) => {\n      setParticipants((prevParticipants) => [...prevParticipants, participant]);\n    };\n\n    const participantDisconnected = (participant) => {\n      setParticipants((prevParticipants) =>\n        prevParticipants.filter((p) => p !== participant)\n      );\n    };\n\n    room.on(\"participantConnected\", participantConnected);\n    room.on(\"participantDisconnected\", participantDisconnected);\n    room.participants.forEach(participantConnected);\n    return () => {\n      room.off(\"participantConnected\", participantConnected);\n      room.off(\"participantDisconnected\", participantDisconnected);\n    };\n  }, [room]);\n\n  const remoteParticipants =\n    participants.length === 1 ? (\n      participants.map((participant) => (\n        <Participant key={participant.sid} participant={participant} />\n      ))\n    ) : (\n      <div className=\"title\"> Waiting for other participant to join .</div>\n    );\n\n  const getRedirection = () => {\n    if (\n      role &&\n      userId !== bookingData?.doctorData?._id &&\n      userId !== bookingData?.patientData?._id\n    ) {\n      Swal.fire(\"Meeting Expired\", \"\", \"error\");\n      history.push(role === \"doctor\" ? \"/doc/consulation\" : \"/pat/consulation\");\n    }\n  };\n\n  // on metting leave\n  const onMeetingLeave = () => {\n    Swal.fire({\n      title: \"Are you sure?\",\n      text: \"you wanna leave meeting ?\",\n      icon: \"warning\",\n      showCancelButton: true,\n      cancelButtonText: \"No\",\n      confirmButtonText: \"Yes\",\n\n      confirmButtonColor: \"#c82333\",\n    }).then((result) => {\n      if (result.isConfirmed) {\n        handleLogout();\n      }\n    });\n  };\n  // main return\n  return (\n    <>\n      <div className=\"container-fluid headerPadding  \">\n        <div className=\"row basicRow waitingRoom px-0\">\n          <div className=\" col-lg-8 col-md-12 col-sm-12\">\n            <div className=\"videoDiv\">\n              <div className=\"videoControls\">\n                <button\n                  onClick={() => setIsVideo(!isVideo)}\n                  className={isVideo ? \"\" : \"active\"}\n                >\n                  <img\n                    src=\"/images/video.svg\"\n                    alt=\"video\"\n                    className=\"icon\"\n                  ></img>\n                </button>\n                <button\n                  onClick={() => setIsAudio((prev) => !prev)}\n                  className={isAudio ? \"\" : \"active\"}\n                >\n                  <img src=\"/images/mic.svg\" alt=\"audio\" className=\"icon\"></img>\n                </button>\n              </div>\n              {remoteParticipants}\n\n              <div className=\"myVideoDiv\">\n                <Participant\n                  localUser\n                  isAudio={isAudio}\n                  isVideo={isVideo}\n                  key={room.localParticipant.sid}\n                  participant={room.localParticipant}\n                />\n              </div>\n            </div>\n          </div>\n          {isLoading || (\n            <div className=\"col-lg-4 col-md-12  col-sm-12\">\n              {getRedirection()}\n              <div className=\" flexCenter header\">\n                <img\n                  src={profileImage || docProfile}\n                  alt=\"profile\"\n                  className=\"img\"\n                ></img>\n                <div className=\"ml-2\">\n                  <div className=\"waitingText\">Consulation room of</div>\n                  <div className=\"name\">\n                    Dr. {bookingData?.doctorData?.name}\n                  </div>\n                  <div className=\"workText\">Doctor</div>\n                </div>\n              </div>\n              <div className=\"flexBetweenCenter detailsDiv\">\n                <div className=\"item\">\n                  <div className=\"title\">Patient</div>\n                  <div className=\"text\"> {bookingData?.patientData?.name}</div>\n                </div>\n                <div className=\"item\">\n                  <div className=\"title\">Appointment time</div>\n                  <div className=\"text\">\n                    {formatDate(\n                      parseISO(bookingData?.bookingDate?.start),\n                      \"Pp\"\n                    )}\n                  </div>\n                </div>\n              </div>\n              <button onClick={onMeetingLeave} className=\"btn btn-danger w-100\">\n                Leave Meeting\n              </button>\n            </div>\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport default Room;\n","import React, { useState, useCallback, useEffect } from \"react\";\nimport { useLocation } from \"react-router\";\nimport { useSelector } from \"react-redux\";\nimport Video from \"twilio-video\";\nimport API from \"../../../config/AxiosBase\";\nimport { headers } from \"../../../helpers/helpers\";\nimport Room from \"./Room\";\nimport history from \"../../../helpers/history\";\nimport Loading from \"../../../components/common/Loading\";\nimport \"./video.css\";\n\nconst VideoChat = () => {\n  const { user } = useSelector((state) => state.auth);\n  const role = user?.role;\n\n  const queryUrl = new URLSearchParams(useLocation().search);\n  const roomId = queryUrl.get(\"roomId\");\n  const userName = queryUrl.get(\"name\");\n  const [room, setRoom] = useState(null);\n  const [connecting, setConnecting] = useState(false);\n\n  useEffect(() => {\n    const connectVideo = async () => {\n      setConnecting(true);\n      try {\n        headers();\n        const response = await API.post(\"/videoChat/video/token\", {\n          name: userName,\n          bookingId: roomId,\n        });\n        Video.connect(response.data.token, { name: roomId }).then((room) => {\n          setConnecting(false);\n          setRoom(room);\n        });\n      } catch (error) {\n        console.error(error);\n        setConnecting(false);\n      }\n    };\n\n    connectVideo();\n  }, [roomId, userName]);\n\n  const handleLogout = useCallback(() => {\n    setRoom((prevRoom) => {\n      if (prevRoom) {\n        prevRoom.localParticipant.tracks.forEach((trackPub) => {\n          trackPub.track.stop();\n        });\n        prevRoom.disconnect();\n\n        history.push(\n          role === \"doctor\"\n            ? \"/dashboard/consulation\"\n            : `/dashboard/consulation?review=true&&bookingId=${roomId}`\n        );\n      }\n      return null;\n    });\n  }, []);\n\n  useEffect(() => {\n    if (room) {\n      const tidyUp = (event) => {\n        if (event.persisted) {\n          return;\n        }\n        if (room) {\n          handleLogout();\n        }\n      };\n      window.addEventListener(\"pagehide\", tidyUp);\n      window.addEventListener(\"beforeunload\", tidyUp);\n      return () => {\n        window.removeEventListener(\"pagehide\", tidyUp);\n        window.removeEventListener(\"beforeunload\", tidyUp);\n      };\n    }\n  }, [room, handleLogout]);\n\n  let render;\n  if (room) {\n    render = (\n      <Room\n        userId={userName}\n        roomName={roomId}\n        room={room}\n        handleLogout={handleLogout}\n        role={role}\n      />\n    );\n  } else {\n    render = <Loading />;\n  }\n  return render;\n};\n\nexport default VideoChat;\n","import React from \"react\";\nimport LoadingComponent from \"@material-ui/core/CircularProgress\";\nexport default function Loading({ height = \"80vh\" }) {\n  return (\n    <div className=\"centerFlex\" style={{ height: height, width: \"100%\" }}>\n      <LoadingComponent />\n    </div>\n  );\n}\n"],"sourceRoot":""}