(this.webpackJsonpclouddoc=this.webpackJsonpclouddoc||[]).push([[36],{1048:function(e,t,n){},1109:function(e,t){},1151:function(e,t){},1229:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return S}));var c=n(183),r=n(16),a=n.n(r),i=n(25),s=n(118),u=n(0),o=n.n(u),l=n(1212),d=n(27),j=n(238),v=n(1213),f=n(28),b=n(34),m=n(3),h=function(e){var t=e.userId,n=e.message,c=e.userProfile,r=e.otherProfile,s=null===n||void 0===n?void 0:n.state,u=s.author,o=s.body,l=s.type,d=u===t,j=function(){return Object(m.jsxs)("div",{className:d?"messageDiv myMessage":"messageDiv ",children:[Object(m.jsx)("img",{src:d?c:r,className:"msgImg"}),Object(m.jsx)("div",{className:"messageText",children:o})]})},v=function(){var e=n.state.media,t=function(){var t=Object(i.a)(a.a.mark((function t(){var n;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getContentTemporaryUrl();case 2:n=t.sent,window.open(n);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(m.jsxs)("div",{className:d?"messageDiv myMessage":"messageDiv ",children:[Object(m.jsx)("img",{src:d?c:r,className:"msgImg"}),Object(m.jsxs)("div",{onClick:t,className:"messageText  pointer",style:{textAlign:"center"},children:["click to open file :"," ",Object(m.jsx)("span",{style:{fontFamily:"poppinsSb"},children:e.state.filename})]})]})};return function(){switch(l){case"text":return Object(m.jsx)(j,{});case"media":return Object(m.jsx)(v,{});default:return Object(m.jsx)(j,{})}}()},p=o.a.memo(h),O=n(15);function x(e){var t,n,r,o,h=e.active,x=e.back,g=e.client,w=Object(u.useState)([]),y=Object(s.a)(w,2),N=y[0],k=y[1],I=Object(u.useState)(""),C=Object(s.a)(I,2),S=C[0],E=C[1],D=new Event("unMount"),_=Object(u.useRef)(null),T=Object(u.useState)(!1),F=Object(s.a)(T,2),M=F[0],q=F[1],B=Object(u.useState)(null),P=Object(s.a)(B,2),R=P[0],A=P[1],K=null===h||void 0===h?void 0:h._id,L=Object(u.useRef)(),U=Object(d.c)((function(e){return e.auth})).user,J=null===U||void 0===U?void 0:U._id,V="None"!==(null===U||void 0===U||null===(t=U.image)||void 0===t?void 0:t.url)&&f.d+(null===U||void 0===U||null===(n=U.image)||void 0===n?void 0:n.url)||b.b,z="None"!==(null===h||void 0===h||null===(r=h.image)||void 0===r?void 0:r.url)&&f.d+(null===h||void 0===h||null===(o=h.image)||void 0===o?void 0:o.url)||b.b,G=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.getSubscribedChannels().then((function(){t.getChannelByUniqueName(K).then(function(){var t=Object(i.a)(a.a.mark((function t(n){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:_.current=n,n.join().then(Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getMessages();case 2:t=e.sent,k(null===t||void 0===t?void 0:t.items),W(),window.addEventListener("beforeunload",(function(){return n.leave()})),window.addEventListener("unMount",(function(){try{n.leave()}catch(e){console.log(e)}}),!1);case 7:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e),console.log("Could not join channel.")})),e(n);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(){return H(t)}))})).catch((function(){return console.log("Could not get channel list.")}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),H=function(){var e=Object(i.a)(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){t.createChannel({uniqueName:K,friendlyName:K}).then((function(){return G(t)})).then(Q).catch((function(){return console.log("Could not create new channel")}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Q=function(e){e.on("messageAdded",(function(e){!function(e){k((function(t){return[].concat(Object(c.a)(t),[e])})),W()}(e)})),e.on("typingStarted",(function(){q(!0),W()})),e.on("typingEnded",(function(){q(!1)}))};Object(u.useEffect)((function(){if(g)return G(g).then(Q).catch((function(e){console.log(e.message)})),function(){var e;null===(e=_.current)||void 0===e||e.leave(),window.dispatchEvent(D),k([])}}),[h,g]);var W=function(){var e,t=document.getElementById("messageEndRef");L?null===(e=L.current)||void 0===e||e.scrollIntoView():null===t||void 0===t||t.scrollIntoView()},X=function(){var e=Object(i.a)(a.a.mark((function e(t){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),S||R){e.next=3;break}return e.abrupt("return");case 3:if(n=new FormData,null!==R&&n.append("file",R),e.prev=5,!_.current){e.next=10;break}return _.current.sendMessage(null!==R?n:S),e.next=10,O.a.put("/chat/chat-room/".concat(K),{new:[J]});case 10:E(""),A(null),W(),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(5),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[5,15]])})));return function(t){return e.apply(this,arguments)}}();return Object(m.jsx)(m.Fragment,{children:Object(m.jsxs)("div",{className:"messageSec",children:[Object(m.jsxs)("div",{className:"flexBetweenCenter header",children:[Object(m.jsxs)("div",{className:"flexCenter",children:[Object(m.jsx)(l.a,{onClick:x,className:"d-md-none pointer"}),Object(m.jsxs)("div",{className:"userItem",style:{height:"100%",padding:"0"},children:[Object(m.jsx)("img",{src:z,className:"profileImg"}),Object(m.jsxs)("div",{children:[Object(m.jsx)("div",{className:"name",children:null===h||void 0===h?void 0:h.name}),Object(m.jsx)("div",{className:"text textBlue",children:null===h||void 0===h?void 0:h.patCondition})]})]})]}),Object(m.jsx)("div",{className:"moreIconDiv",children:Object(m.jsx)("img",{src:"/images/moreIcon.png",className:"moreIcon pointer",style:{width:"4px"},alt:"Icon "})})]}),Object(m.jsxs)("div",{className:"innerMessageSec",children:[null===N||void 0===N?void 0:N.map((function(e){return Object(m.jsx)(p,{message:e,userId:J,userProfile:V,otherProfile:z},null===e||void 0===e?void 0:e._id)})),M&&Object(m.jsxs)("div",{className:"messageDiv",children:[Object(m.jsx)("img",{src:z,className:"msgImg"}),Object(m.jsx)("div",{className:"messageText",style:{width:"fit-content"},children:"Typing ..."})]}),Object(m.jsx)("div",{id:"messageEndRef",ref:L})]}),Object(m.jsx)("div",{className:"bottomSec",children:Object(m.jsxs)("div",{className:"sendDiv",children:[Object(m.jsxs)("div",{className:"choose_file",children:[Object(m.jsx)("div",{className:"attachmentDiv",children:Object(m.jsx)("img",{className:"attachmentIcon pointer",src:"/images/attach.svg",style:{width:"100%"},alt:"icon"})}),Object(m.jsx)("input",{onChange:function(e){return A(e.target.files[0])},type:"file",onKeyUp:function(e){return"Enter"===e.key&&X(e)}})]}),null===R?Object(m.jsx)("input",{onChange:function(e){E(e.target.value),_.current.typing()},value:S,className:"sendInput",placeholder:"Type your question here\u2026",onKeyUp:function(e){return"Enter"===e.key&&X(e)}}):Object(m.jsxs)("div",{className:"fileInputDiv",children:[Object(m.jsxs)("span",{children:[" ",null===R||void 0===R?void 0:R.name]}),Object(m.jsx)(j.a,{onClick:function(){return A(null)},children:Object(m.jsx)(v.a,{})})]}),Object(m.jsx)("div",{onClick:X,className:"sendIconDiv",children:Object(m.jsx)("img",{className:"sendIcon pointer",src:"/images/send.svg",style:{width:"100%"},alt:"icon"})})]})})]})})}var g=n(4);function w(e){var t=e.data,n=e.active,c=e.onCallback,r=e.userId;return Object(m.jsx)(m.Fragment,{children:t.map((function(e,t){return Object(u.createElement)(y,Object(g.a)(Object(g.a)({},e),{},{active:n,userId:r,onCallback:c,key:t}))}))})}var y=function(e){var t=e.new,n=e.name,c=e.patCondition,r=e.image,a=e._id,i=e.active,s=e.onCallback,u=e.userId;return Object(m.jsxs)("div",{onClick:function(){return s({name:n,patCondition:c,image:r,_id:a})},className:a===(null===i||void 0===i?void 0:i._id)?"userItem userItemActive":"userItem",children:[!0===(null===t||void 0===t?void 0:t.includes(u))||Object(m.jsx)("div",{className:"new"}),Object(m.jsx)("img",{src:"None"!==(null===r||void 0===r?void 0:r.url)&&f.d+(null===r||void 0===r?void 0:r.url)||b.b,className:"profileImg"}),Object(m.jsxs)("div",{children:[Object(m.jsx)("div",{className:"name",children:n}),Object(m.jsx)("div",{className:"text textBlue",children:c})]})]})},N=n(154),k=n(225),I=(n(1048),n(202)),C=n(1049);function S(){var e,t=Object(u.useState)(null),n=Object(s.a)(t,2),r=n[0],o=n[1],l=Object(u.useState)([]),j=Object(s.a)(l,2),v=j[0],b=j[1],h=Object(u.useState)([]),p=Object(s.a)(h,2),g=p[0],y=p[1],S=Object(u.useState)(""),E=Object(s.a)(S,2),D=E[0],_=E[1],T=Object(u.useRef)(null),F=Object(u.useState)(!1),M=Object(s.a)(F,2),q=M[0],B=M[1],P=Object(u.useState)(""),R=Object(s.a)(P,2),A=(R[0],R[1]),K=Object(d.c)((function(e){return e.auth})).user,L=null===K||void 0===K?void 0:K._id,U=Object(d.b)();Object(u.useEffect)((function(){return U(Object(I.a)("Messaging")),function(){}}),[]);var J=function(){var t=Object(i.a)(a.a.mark((function t(){return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(k.b)();case 2:return e=t.sent,A(e.identity),t.next=6,C.Client.create(e.token);case 6:T.current=t.sent,B(!1);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(u.useEffect)((function(){var e=function(){var e=Object(i.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return B(!0),e.prev=1,Object(f.c)(),e.next=5,O.a.get("/chat/get-chat-rooms");case 5:t=e.sent,b(t.data),y(t.data),t.data.length>0&&o(null===t||void 0===t?void 0:t.data[0]),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(){return e.apply(this,arguments)}}();return J(),e(),function(){}}),[]),Object(u.useEffect)((function(){var e;if(r&&!(null===(e=r.new)||void 0===e?void 0:e.includes(L))){var t=v.filter((function(e){return e._id===r._id&&(e.new=[].concat(Object(c.a)(null===e||void 0===e?void 0:e.new),[L])),e}));b(t),function(){var e=Object(i.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.put("/chat/chat-room/".concat(null===r||void 0===r?void 0:r._id),{new:[].concat(Object(c.a)(r.new),[L])});case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}()()}return function(){}}),[r]);var V=function(e){var t=e.target.value;_(t);var n=g.filter((function(e){return e.name.toLowerCase().indexOf(t.toLowerCase())>-1}));b(n)},z=function(){return Object(m.jsxs)("div",{className:"searchBar",children:[Object(m.jsx)("input",{onChange:V,placeholder:"Seacrh",className:"search",value:D,autoFocus:""!==D}),Object(m.jsx)("div",{className:"searchIconDiv",children:Object(m.jsx)("img",{className:"searchIcon w-100",src:"/images/searchIcon.png",alt:"search"})})]})};return Object(m.jsx)("div",{className:"contentRow py-3",children:Object(m.jsxs)("div",{className:"secDiv p-0 message",children:[q&&Object(m.jsx)(N.a,{}),q||Object(m.jsxs)("div",{className:"mainFlex",children:[Object(m.jsxs)("div",{className:"userSec d-none d-md-block",children:[Object(m.jsx)(z,{}),Object(m.jsx)("div",{className:"overFlowAuto",children:Object(m.jsx)(w,{userId:L,data:v,active:r,onCallback:function(e){return o(e)}})})]}),null!==r||Object(m.jsxs)("div",{className:"userSec d-md-none",children:[Object(m.jsx)(z,{}),Object(m.jsx)("div",{className:"overFlowAuto",children:Object(m.jsx)(w,{userId:L,data:v,active:r,onCallback:function(e){return o(e)}})})]}),null!==r&&Object(m.jsx)(x,{client:T.current,active:r,back:function(){return o(null)}})]})]})})}},154:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(0);var c=n(296),r=n(3);function a(e){var t=e.height,n=void 0===t?"80vh":t;return Object(r.jsx)("div",{className:"centerFlex",style:{height:n,width:"100%"},children:Object(r.jsx)(c.a,{})})}},202:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var c=n(35),r=function(e){return{type:c.b,payload:e}}},225:function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"g",(function(){return j})),n.d(t,"j",(function(){return v})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"b",(function(){return m})),n.d(t,"h",(function(){return h}));var c=n(16),r=n.n(c),a=n(25),i=n(15),s=n(28),u=function(){return Object(s.c)(),i.a.get("/notification/?seen=true")},o=function(){return Object(s.c)(),i.a.get("/notification/")},l=function(){return Object(s.c)(),i.a.delete("/notification/")},d=function(){return Object(s.c)(),i.a.get("/docprofile")},j=function(){return Object(s.c)(),i.a.get("/patprofile")},v=function(e){var t="physical"===(null===e||void 0===e?void 0:e.type)?{physicalTimeSlot:e.slots}:{videoTimeSlot:e.slots};return Object(s.c)(),i.a.put("/docprofile/update-event",t)},f=function(e){var t=e.queryKey[1];return Object(s.c)(),i.a.get("/booking/?visitType=physical&&count=".concat(t))},b=function(e){var t=e.queryKey[1];return Object(s.c)(),i.a.get("/booking/?visitType=video&&count=".concat(t))},m=function(){var e=Object(a.a)(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(s.c)(),e.next=3,i.a.get("/chat/token");case 3:return t=e.sent,n=t.data,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(e){var t=e.queryKey[1];return Object(s.c)(),i.a.get("/patprofile/get-payments?count=".concat(t))}}}]);
//# sourceMappingURL=36.89059536.chunk.js.map